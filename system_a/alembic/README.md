# Alembic Database Migrations

This directory contains database migration scripts managed by Alembic.

## Configuration

The database URL can be configured in several ways:

1. **Environment variable**: Set `DATABASE_URL` environment variable
2. **Settings**: Configure in `app/config.py`

## Commands

### Generate a new migration (autogenerate)

```bash
cd system_a
alembic revision --autogenerate -m "Description of changes"
```

### Run all pending migrations

```bash
alembic upgrade head
```

### Rollback one migration

```bash
alembic downgrade -1
```

### Rollback to a specific revision

```bash
alembic downgrade <revision_id>
```

### Show current migration status

```bash
alembic current
```

### Show migration history

```bash
alembic history
```

### Generate SQL without executing (offline mode)

```bash
alembic upgrade head --sql > migration.sql
```

## File Structure

- `env.py` - Environment configuration for migrations
- `script.py.mako` - Template for generating migration files
- `versions/` - Directory containing migration scripts

## Best Practices

1. Always review autogenerated migrations before running them
2. Test migrations in a development/staging environment first
3. Create atomic migrations (one logical change per migration)
4. Write meaningful migration descriptions
5. Always implement both `upgrade()` and `downgrade()` functions
